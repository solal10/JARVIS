"use strict";(()=>{var e={};e.id=823,e.ids=[823],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2562:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>v,patchFetch:()=>S,requestAsyncStorage:()=>p,routeModule:()=>g,serverHooks:()=>y,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>w});var i={};r.r(i),r.d(i,{GET:()=>d,POST:()=>c});var a=r(884),s=r(6132),n=r(1040),l=r(5798),o=r(4051);async function c(){try{let e=await fetch(`${process.env.NEXT_PUBLIC_APP_URL||"http://localhost:3000"}/api/trends`);if(!e.ok)throw Error("Erreur lors de l'analyse des tendances");let t=await e.json();if(!t.success||0===t.articleIdeas.length){let e=[{topic:"Intelligence Artificielle G\xe9n\xe9rative en Entreprise 2024",category:"Audit IA",keywords:["IA g\xe9n\xe9rative","ChatGPT entreprise","automatisation","productivit\xe9","2024"],priority:40},{topic:"Next.js 15 : Nouvelles Fonctionnalit\xe9s et Performance",category:"D\xe9veloppement",keywords:["Next.js 15","React","performance","d\xe9veloppement web","2024"],priority:35}],t=e[Math.floor(Math.random()*e.length)];return await u(t)}let r=t.articleIdeas.sort((e,t)=>t.priority-e.priority).slice(0,3),i=(0,o.y8)(),a=i.filter(e=>{let t=(Date.now()-new Date(e.createdAt).getTime())/864e5;return t<7}).map(e=>e.slug),s=r.filter(e=>{let t=(0,o.Ov)(e.suggestedTitle||e.topic);return!a.includes(t)});if(0===s.length)return l.Z.json({success:!1,message:"Tous les sujets tendances ont \xe9t\xe9 r\xe9cemment trait\xe9s",nextRun:"Prochaine ex\xe9cution dans quelques heures"});let n=s[0];return await u(n)}catch(e){return l.Z.json({success:!1,error:"Erreur lors de la g\xe9n\xe9ration automatique du blog",details:e instanceof Error?e.message:"Erreur inconnue"},{status:500})}}async function u(e){try{let t=await fetch(`${process.env.NEXT_PUBLIC_APP_URL||"http://localhost:3000"}/api/generate-article`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({topic:e.topic||e.suggestedTitle,category:e.category,keywords:e.keywords||[e.topic],priority:e.priority||25})});if(!t.ok)throw Error("Erreur lors de la g\xe9n\xe9ration de l'article");let r=await t.json();if(!r.success){if(r.fallbackArticle){let t={...r.fallbackArticle,slug:(0,o.Ov)(r.fallbackArticle.title),status:"published",views:0,trending:e.priority>30},i=(0,o.j8)(t);return l.Z.json({success:i,message:i?"Article g\xe9n\xe9r\xe9 et sauvegard\xe9 avec fallback":"Erreur lors de la sauvegarde",article:i?t:null,usedFallback:!0})}throw Error("\xc9chec de la g\xe9n\xe9ration d'article et aucun fallback disponible")}let i={...r.article,slug:(0,o.Ov)(r.article.title),status:"published",views:0},a=(0,o.j8)(i);if(!a)throw Error("Erreur lors de la sauvegarde de l'article");return l.Z.json({success:!0,message:"Article g\xe9n\xe9r\xe9 et publi\xe9 avec succ\xe8s",article:{title:i.title,slug:i.slug,category:i.category,readTime:i.readTime,trending:i.trending},stats:{wordCount:r.wordCount,generatedAt:new Date().toISOString()}})}catch(e){throw e}}async function d(){return await c()}let g=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auto-generate-blog/route",pathname:"/api/auto-generate-blog",filename:"route",bundlePath:"app/api/auto-generate-blog/route"},resolvedPagePath:"/Users/thomasbenichou/Desktop/JARVIS/frontend/src/app/api/auto-generate-blog/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:p,staticGenerationAsyncStorage:f,serverHooks:y,headerHooks:h,staticGenerationBailout:w}=g,v="/api/auto-generate-blog/route";function S(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:f})}},4051:(e,t,r)=>{r.d(t,{N_:()=>p,Nh:()=>v,Ov:()=>S,Wg:()=>f,j8:()=>d,v:()=>h,vA:()=>y,y8:()=>g});var i=r(7147),a=r.n(i),s=r(1017),n=r.n(s);let l=n().join(process.cwd(),"src","data","blog"),o=n().join(l,"articles.json"),c=n().join(l,"stats.json");function u(){a().existsSync(l)||a().mkdirSync(l,{recursive:!0}),a().existsSync(o)||a().writeFileSync(o,JSON.stringify([],null,2)),a().existsSync(c)||a().writeFileSync(c,JSON.stringify({totalArticles:0,publishedArticles:0,totalViews:0,lastGenerated:null,categoriesStats:{},topKeywords:[]},null,2))}function d(e){try{u();let t=g(),r=t.findIndex(t=>t.slug===e.slug);return r>=0?t[r]={...e,lastModified:new Date().toISOString()}:t.push(e),a().writeFileSync(o,JSON.stringify(t,null,2)),w(),!0}catch(e){return!1}}function g(){try{if(u(),!a().existsSync(o))return[];let e=a().readFileSync(o,"utf-8");return JSON.parse(e)}catch(e){return[]}}function p(){let e=g();return e.filter(e=>"published"===e.status)}function f(e){let t=g();return t.find(t=>t.slug===e)||null}function y(e=10){let t=p();return t.sort((e,t)=>new Date(t.publishedAt).getTime()-new Date(e.publishedAt).getTime()).slice(0,e)}function h(e){try{let t=g(),r=t.findIndex(t=>t.slug===e);r>=0&&(t[r].views=(t[r].views||0)+1,a().writeFileSync(o,JSON.stringify(t,null,2)),w())}catch(e){}}function w(){try{let e=g(),t=e.filter(e=>"published"===e.status),r={};t.forEach(e=>{r[e.category]=(r[e.category]||0)+1});let i={};t.forEach(e=>{e.keywords.forEach(e=>{i[e]=(i[e]||0)+1})});let s=Object.entries(i).sort(([,e],[,t])=>t-e).slice(0,20).map(([e,t])=>({keyword:e,count:t})),n=e.reduce((e,t)=>e+(t.views||0),0),l={totalArticles:e.length,publishedArticles:t.length,totalViews:n,lastGenerated:new Date().toISOString(),categoriesStats:r,topKeywords:s};a().writeFileSync(c,JSON.stringify(l,null,2))}catch(e){}}function v(){try{if(u(),!a().existsSync(c))return{totalArticles:0,publishedArticles:0,totalViews:0,lastGenerated:null,categoriesStats:{},topKeywords:[]};let e=a().readFileSync(c,"utf-8");return JSON.parse(e)}catch(e){return null}}function S(e){let t=g(),r=e.toLowerCase().replace(/[àáâäæãåāăą]/g,"a").replace(/[çćčĉċ]/g,"c").replace(/[èéêëēėęěĕ]/g,"e").replace(/[ìíîïīįìĩĭ]/g,"i").replace(/[òóôöőõøōŏ]/g,"o").replace(/[ùúûüūůűũŭ]/g,"u").replace(/[ñń]/g,"n").replace(/[ß]/g,"ss").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").substring(0,50),i=1,a=r;for(;t.some(e=>e.slug===a);)a=`${r}-${i}`,i++;return a}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[271,107],()=>r(2562));module.exports=i})();